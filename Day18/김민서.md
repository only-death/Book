# 21. 빌트인 객체

## 21.1 자바스크립트 객체의 분류

- 표준 빌트인 객체
  - 표준 빌트인 객체는 ECMAScript 사양에 정의된 객체를 말하며, 애플리케이션 전역의 공통 기능을 제공한다.
  - 표준 빌트인 객체는 ECMAScript 사양에 정의된 객체이므로 자바스크립트 실행환경에 관계없이 언제나 사용할 수 이싸.
  - 표준 빌트인 객체는 전역 객체의 프로퍼티로서 제공된다. 따라서 별도의 선언 없이 전역 변수처럼 언제나 참조할 수 있다.
- 호스트 객체
  - ECMAScript 사양에 정의되어 있지 않지만 자바스크립트 실행환경에서 추가로 제공하는 객체를 말한다.
  - 브라우저 환경에서는 DOM, BOM, Canvas, XMLttpRequest, fetch, requestAnimationFrame, SVG, Web Storage, Web Component, Web Worker 와 같은 클라이언트 사이드 Web API 를 호스트 객체로 제공하고
  - Node.js 환경에서는 Node.js 고유의 API를 호스트 객체로 제공한다.
- 사용자 정의 객체
  - 사용자 정의 객체는 표준 빌트인 객체와 호스트 객체처럼 기본 제공되는 객체가 아닌 사용자가 직접 정의한 객체를 말한다.


## 21.2 표준 빌트인 객체
- 자바스크립트는 Object, String, Number, Boolean, Symbol, Date, Math, RegExp, Array, Map/set, WeakMap/WeakSet, Function, Promise, Reflect, Proxy, JSON, Error 등 40여 개의 표준 빌트인 객체를 제공한다.
- Math, Reflect, JSON 을 제외한 표준 빌트인 객체는 모두 인스턴스를 생성할 수 있는 생성자 함수 객체다.
- 생성자 함수 객체인 표준 빌트인 객체는 프로토타입 메서드와 정적 메서드를 제공하고 생성자 함수 객체가 아닌 표준 빌트인 객체는 정적 메서드만 제공한다.
- 생성자 함수인 표준 빌트인 객체가 생성한 인스턴스의 프로토타입은 표준 빌트인 객체의 prototype 프로퍼티에 바인딩된 객체다.
- 표준 빌트인 객체의 prototype 프로퍼티에 바인딩된 객체는 다양한 기능의 빌트인 프로토타입 메서드를 제공한다.
- 표준 빌트인 객체는 인스턴스 없이도 호출 가능한 빌트인 정적 메서드를 제공한다.

## 21.3 원시값과 래퍼 객체
- 원시값을 객체처럼 사용하면 자바스크립트 엔진은 암묵적으로 연관된 객체를 생성하여 생성된 객체로 프로퍼티에 접근하거나 메서드를 호출하고 다시 원시값으로 되돌린다.
- **문자열, 숫자, 불리언 값에 대해 객체처럼 접근하면 생성되는 임시 객체를 래퍼 객체** 라고 한다.

## 21.4 전역 객체
- 코드가 실행되기 이전 단계에 자바스크립트 엔진에 의해 어떤 객체보다도 먼저 생성되는 특수한 객체이며, 어떤 객체에도 속하지 않은 최상위 객체다.
- 자바스크립트 환경에 따라 지칭하는 이름이 제각각이다.
- 브라우저
  - window(또는 self, this, frames)
- Node.js
  - global
- 표준 빌트인 객체(Object, String, Number, Function, Array 등) 와 환경에 따른 호스트 객체, 그리고 var 키워드로 선언한 전역 변수와 전역 함수를 프로퍼티로 갖는다. <br>
=> 계층적 구조상 어떤 객체에도 속하지 않은 모든 빌트인 객체의 최상위 객체다.

### 21.4.1 빌트인 전역 프로퍼티
- 전역 객체의 프로퍼티를 의미한다.
- 주로 애플리케이션 전역에서 사용하는 값을 제공한다.

#### Infinity
- 무한대를 나타내는 숫자값 Infinity를 갖는다.

#### NaN
- 숫자가 아님을 나타내는 숫자값 NaN을 갖는다.
- Number.NaN 프로퍼티와 같다.

#### undefined
- 원시 타입 undefined를 값으로 갖는다.

### 21.4.2 빌트인 전역 함수
- 애플리케이션 전역에서 호출할 수 있는 빌트인 함수로서 전역 객체의 메서드다.

#### eval
- 자바스크립트 코드를 나타내는 문자열을 인수로 전달받는다.
- 전달 받은 문자열 코드가 표현식이라면
  - 문자열 코드를 런타임에 평가하여 값을 생성
- 전달 받은 인수가 표현식이 아닌 문이라면
  - 문자열 코드를 런타임에 실행한다.
- 문자열 코드가 여러 개의 문으로 이루어져 있다면 모든 문을 실행한다.
- 기존의 스코프를 런타임에 동적으로 수정한다 + 전달된 코드는 이미 그 위치에 존재하던 코드처럼 동작한다. <br>
=> 사용은 금지해야 한다.

#### isFinite
- 전달받은 인수가 정상적은 유한수이면
  - `true` 를 반환
- 무한수이면
  - `false` 를 반환
- 숫자가 아닌 경우
  - 숫자로 타입을 변환한 후 검사를 수행한다.
- 인수가 NaN으로 평가되는 값이면
  - `false` 를 반환

#### isNaN
- 전달받은 인수가 NaN인지 검사하여 그 결과를 불리언 타입으로 변환한다.
- 전달 받은 인수의 타입이 숫자가 아닌 경우 숫자로 타입을 변환한 후 검사를 수행한다.

#### parseFloat
- 전달받은 문자열 인수를 부동 소수점 숫자, 즉 실수로 해석하여 반환한다.

#### parseInt
- 전달받은 문자열 인수로 정수로 해석하여 반환한다.

#### encodeURI / decodeURI
- encodeURI 함수는 완전한 URI를 문자열로 전달받아 이스케이프 처리를 위해 인코딩한다.
  - 인코딩이란 URI의 문자들을 이스케이프 처리하는 것을 의미한다.
  - 네트워크를 통해 정보를 공유할 때 어떤 시스템에서도 읽을 수 있는 아스키 문자 셋으로 변환하는 것이다.
- URI은 아스키 문자 셋으로만 구성되어야 하며 한글을 포함한 대부분의 외국어나 아스키 문자 셋에 정의되지 않은 특수 문자의 경우 URI에 포함될 수 없다.
- 의미를 갖고 있는 문자(%, ?, #) 나 URL에 올 수 없는 문자(한글, 공백 등) 또는 시스템에의해 해석될 수 있는 문자(< , >) 를 이스케이프 처리하여 야기될 수 있는 문제를 예방하기 위한 이스케이프 처리가 필요하다.
- 단, 알파벳, 0~9의 숫자, - _ . ! ~ * ' () 문자는 이스케이프 처리에서 제외된다.
- decodeURI 함수는 인코딩된 URI를 인수로 전달받아 이스케이프 처리 이전으로 디코딩한다.

#### encodeURIComponent/ decodeURIComponent
- encodeURIComponent 함수는 URI 구성 요소를 인수로 전달받아 인코딩한다.
- 알파벳, 0~9의 숫자,  - _ . ! ~ * ' () 문자는 이스케이프 처리에서 제외된다.
- decodeURICOmponent 함수는 매개변수로 전달된 URI 구성 요소를 디코딩한다.

### 21.4.3 암묵적 전역
- 자바스크립트 엔진은 전역 객체의 프로퍼티를 동적으로 생성하면 전역 객체의 프로퍼티가 되어 전역 변수처럼 동작한다.
- 변수가 아니므로 변수 호이스팅이 발생하지 않는다.

# 22. this

## 22.1 this 키워드
- 자신이 속한 객체 또는 자신이 생성할 인스턴스를 가리키는 자기 참조 변수다.
- this를 통해 자신이 속한 객체 또는 자신이 생성할 인스턴스의 프로퍼티나 메서드를 참조할 수 있다.
- 자바스크립트 엔진에 의해 암묵적으로 생성되며, 코드 어디서든 참조할 수 있다.
- this가 가리키는 값, this 바인딩은 함수 호출 방식에 의해 동적으로 결정된다.
- 함수가 호출되는 방식에 따라 this에 바인딩될 값, 즉 this 바인딩이 동적으로 결정된다.

### this 바인딩
- 바인딩이란 식별자와 값을 연결하는 괒엉을 의미한다.
- this와 this가 가리킬 객체를 바인딩 하는 것이다.

## 22.2 함수 호출 방식과 this 바인딩
- this 바인딩(this에 바인딩될 값)은 함수 호출 방식, 즉 함수가 어떻게 호추로디었는지에 따라 동적으로 결정된다.
- 함수를 호출하는 방식
  - 일반 함수 호출
  - 메서드 호출
  - 생성자 함수 호출
  - Function.prototype.apply/call/bind 메서드에 의한 간접 호출

### 22.2.1 일반 함수 호출
- 기본적으로 this에는 전역 객체가 바인딩된다.
- 중첩 함수를 일반 함수로 호출하면 함수 내부의 this에는 전역 객체가 바인딩된다.
- 다만 this는 객체의 프로퍼티나 메서드를 참조하기 위한 자기 참조 변수이므로 객체를 생성하지 않는 일반 함수에서 this는 의미가 없다. <br>
=> 일반 함수로 호출된 모든 함수(중첩 함수, 콜백 함수 포함) 내부의 this에는 전역 객체가 바인딩된다.

### 22.2.2 메서드 호출
- 메서드 내부의 this에는 메서드를 호출한 객체, 즉 메서드를 호출할 때 메서드 이름 앞의 마침표(..) 연산자 앞에 기술한 객체가 바인딩된다.
- 메서드 내부의 this는 메서드를 소유한 객체가 아닌 메서드를 호출한 객체에 바인딩된다는 것이다.
- 프로토타입 메서드 내부에서 사용된 this도 일반 메서드와 마찬가지로 해당 메서드를 호출한 객체에 바인딩 된다.

### 22.2.3 생성자 함수 호출
- 생성자 함수 내부의 this에는 생성자 함수가 생성할 인스턴스가 바인딩된다.

### 22.2.4 Function.prototype.apply/call/bind 메서드에 의한 간접 호출
- apply, call, bind 메서드는 Function.prototype의 메서드다. <br>
=> 이들 메서드는 모든 함수가 상속받아 사용할 수 있다.

- Function.prototype.apply, Function.prototype.call 메서드는 this로 사용할 객체와 인수 리스트를 인수로 전달받아 함수를 호출한다.
- apply와 call 메서드의 사용법은 아래와 같다.

```js
/**
 * 주어진 this 바인딩과 리스트 배열을 사용하여 함수를 호출한다.
 * @param thisArg - this로 사용할 객체
 * @param argsArray - 함수에게 전달할 인수 리스트의 배열 또는 유사 배열 객체
 * @returns 호출된 함수의 반환값
 */
 Function.prototype.apply(thisArg[, argsArray])

 /**
  * 주어진 this 바인딩과 , 로 구분된 인수 리스트를 사용하여 함수를 호출한다.
  * @param thisArg - this로 사용할 객체
  * @param arg1, arg2, ... - 함수에게 전달할 인수 리스트
  * @returns 호출된 함수의 반환값
  */
 Function.prototype.call (thisArg[, arg1[, arg2[, ...]]])
```

```js
function getThisBinding() {
    return this;
}

// this로 사용할 객체
const thisArg = { a: 1};

console.log(getThisBinding()); // window

// getThisBinding 함수를 호출하면서 인수로 전달한 객체를 getThisBinding 함수의 this에 바인딩한다.
console.log(getThisBinding.apply(thisArg)); // {a: 1}
console.log(getThisBinding.call(thisArg)); // {a: 1}
```

- apply와 call 메서드의 본질적인 기능은 함수를 호출하는 것이다.
- apply와 call 메서드는 함수를 호출하면서 첫 번째 인수로 전달한 특정 객체를 호출한 함수의 this에 바인딩한다.
- apply와 call 메서드는 호출할 함수에 인수를 전달하는 방식만 다를 뿐 동일하게 동작한다.

- apply 메서드는 호출할 함수의 인수를 배열로 묶어 전달한다.
- call 메서드는 호출할 함수의 인수를 쉼표로 구분한 리스트 형식으로 전달한다. <br>
=> apply와 call 메서드는 호출할 함수에 인수를 전달하는 방식만 다를 뿐 this로 사용할 객체를 전달하면서 함수를 호출하는 것은 동일하다. <br>
=> 대표적인 용도는 arguments 객체와 같은 유사 배열 객체에 배열 메서드를 사용하는 경우다. <br>
=> arguments 객체는 배열이 아니기 떄문에 Array.prototype.slice 같은 배열의 메서드를 사용할 수 없으나 apply, call 메서드를 사용하면 가능하다.

- 콜백 함수 내부의 this와 외부 함수 내부의 this랑 불일치 경우<br>
=> bind 메서드를 사용하여 this를 일치시킬 수 있다.

| 호출 방식                           | this 바인딩                           |
|---------------------------------|--------------------------------|
| **일반 함수 호출**              | 전역 객체 (`window` 또는 `global`) |
| **메서드 호출**                 | 메서드를 호출한 객체              |
| **생성자 함수 호출**            | 생성자 함수가 (미래에) 생성할 인스턴스 |
| **Function.prototype.apply / call / bind** | 첫 번째 인수로 전달한 객체 |


